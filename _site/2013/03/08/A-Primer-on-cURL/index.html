
<!DOCTYPE html>
<head>
    <title>Jason Willems</title>
    <link href="/jasonwillems.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" type="image/ico" href="/favicon.ico" />
    <link rel="shotcut icon" href="/favicon.png" />
</head>

<body>
    <div id="page">
       <div id="theheader" class="center">
        <div style="color:white; display:inline-block; margin-top: 20px; margin-left: 40px; font-size:45px"> 
            { ja : son } 
        </div>

        <div id="nav">
            <ul>
                <li><a href="/links" id="homelink"> { Jason } </a></li>
                <li><a href="/travel" id="travellink"> { Traveler } </a></li>
                <li><a href="/" id="bloglink"> { Writer } </a></li>
                <li><a href="/photos" id="photoslink"> { Photographer } </a></li>
                <li><a href="/illustrations" id="illustrationslink"> { Science Geek } </a></li>
            </ul>
        </div>
    </div>

    <div id="middle">
        <div id="body" class="center">

        <h1>A Primer on cURL</h1><br>

<div id="subheading">
	<div id="blogdatestamp" style="font-weight:bold;font-family:times;text-align:center;"><i>08 Mar 2013</i></div>
	<div id="blogtext">
		I was introduced to testing <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">RESTful APIs</a> long before I started web development. Perhaps the most indispensable resource available to me was <a href="http://curl.haxx.se/">cURL</a>, which is a command line utility to send and receive data from servers. I've since encountered various alternatives, and supersets, however none of them has ever been truly as lightweight and easy to set up, use and understand as cURL.<br />
<br />
When we test using cURL, we&rsquo;re really performing the same actions our browser is, but we&rsquo;re able to both send and receive data much less ambiguously, more clearly verify the server is operating as expected, and more easily test things like valid data ranges. Removing the layer of abstraction that the webUI introduces (let alone the variation in the way different browsers react to the same data), enables us design and test our APIs much more confidently.<br />
<br />
<br />
<b>Setup</b><br />
<br />
If you&rsquo;re on a Mac or a Linux PC it&rsquo;s as simple as opening terminal and entering the commands we discuss! (also, type &ldquo;man curl&rdquo; for the included user manual) <br />
<!--more-->
<br/>
<img src="/blog-assets/curl-manual.png" style="margin-left:auto;margin-right:auto;">
<br />
<br />
<b>HTTP Requests</b><br />
<br />
Most RESTful APIs use four main HTTP methods to interact with the server: GET, PUT, POST &amp; DELETE:&#8232;<br />
<ul style="margin-left:45px">
<li><b>GET</b> is used to retrieve content, without making any modifications to it&#8232;</li>
<li><b>POST</b> and <b>PUT</b> are used to create or update resources. There are subtle differences between them (generally a POST is used to update and element, or add to a queue, while a PUT is used to create or replace an element), but it depends somewhat on the program architecture. In this case, simply follow the API Documentation of whatever you're testing for guidance on which to use when.</li>
<li><b>DELETE</b> is used to remove a resource</li><br />
</ul>
At this point, our request might look something like (ignore the prepending &ldquo;X&rdquo;, which we&rsquo;ll go over in the next section):<br />
<br />
<div style="margin-left:45px;display:block">
<div class="highlight"><pre><code class="bash">curl -X GET www.jasonwillems.com
curl -X POST www.jasonwillems.com/api/&lt;resouce-to-update&gt;
</code></pre></div>
</div>
<br />
<br />
<b>cURL Request Flags</b><br />
<br />
In order for our cURL requests to become more powerful, we need to use flags in order to pass important pieces of information. There are many more flags than we&rsquo;ll cover here, but here are a few of the important ones:
<br /><br />
<ul style="margin-left:45px;">
<li>
The <b>&ldquo;-X&rdquo; flag</b> is to override the default curl call (a GET). cURL can be used without it, but it the call must be appended with &ldquo;-X <PUT/POST/DELETE>&rdquo; for any of these requests. </li>
<br />
<div style="margin-left:45px;display:block">
<div class="highlight"><pre><code class="bash">curl -X DELETE www.jasonwillems.com/api/&lt;resource-to-delete&gt;
</code></pre></div>
</div>
 <br />
 <li>
The <b>&ldquo;-H&rdquo; flag</b> is to send a header with the request. Headers will be read first by the server and often specify initial information such as the Cookies for the current session, or the content type. <br />
</li>
<br />
<div style="margin-left:45px;display:block">
<div class="highlight"><pre><code class="bash">curl -X GET www.jasonwillems.com -H <span class="s2">&quot;Content-Type: application/xml&quot;</span>
</code></pre></div>
</div>
 <br />
 <li>
The <b>&ldquo;-d&rdquo; flag</b> is to add data to the request, the same way a browser would send a completed web-form when the user clicks &ldquo;Submit&rdquo;. This flag is required for POST and PUT requests only. <br />
</li>
<br />
<div style="margin-left:45px;display:block">
<div class="highlight"><pre><code class="bash">curl -X POST www.jasonwillems.com/api/login 
     -d <span class="s2">&quot;{&#39;username&#39;:&#39;jason&#39;,&#39;password&#39;:&#39;letmein!&#39;}&quot;</span>
</code></pre></div>
</div>
 <br />
 <li>
The <b>&ldquo;-k&rdquo; flag</b> is the same as the &ldquo;--insecure&rdquo; flag, which will drop any prompts generated regarding the SSL license signing authority. This flag is necessary for all requests. <br />
</li>
<br />
<div style="margin-left:45px;display:block">
<div class="highlight"><pre><code class="bash">curl -X GET https://www.jasonwillems.com -k
</code></pre></div>
</div>
 <br />
<li>
The <b>&ldquo;-v&rdquo; flag</b> specifies a verbose response. This will necessarily include not only the response, but also the header values returned, such as the HTTP status code (ex. 200 OK, 401 Not Authorized, etc). It is recommended to always provide this flag.<br />
</li>
<br />
<div style="margin-left:45px;display:block">
<div class="highlight"><pre><code class="bash">curl -X GET www.jasonwillems.com -v
</code></pre></div>
</div>
</ul>
<br />
<br />
<b>Tools</b><br />
<br />
The the tools that best illustrate these points are the console&rsquo;s included in your browser (and I&rsquo;d highly recommend looking at <a href="https://getfirebug.com/">FireBug</a> for Firefox, which is my personal favourite). Open up the console and you&rsquo;ll be able to see every request your browser makes, the data included in the request, and the response from the server. Perhaps the nicest feature, is the recently added ability to copy the request to the clipboard as cURL request.<br />
<br/>
<img src="/blog-assets/firebug-basic.png">
<br />
<br />
<br />
<b>Going Further</b><br />
<br />
In essence, every time you&rsquo;re on the internet the communication your browser and the server can be broken down into cURL requests like above. But, as a decades old piece of software, cURL does have its limitations.&#8232;<br /><br />
<ul style="margin-left:45px;">
<li>Responses can be returned with various formatting: xml, html, json, text, or something else entirely. cURL won&rsquo;t understand the proper way to display these to you, and things can get messy.</li>
<li>Modern websites will often use authentication protocols like digest, oAuth, or oAuth2. The authentication process for these isn&rsquo;t a straightforward process and cURL has never scaled well to meet these demands.</li>
</ul><br />
To go further, check out the built in Node.js <a href="http://nodejs.org/api/http.html">HTTP module</a>, Python&rsquo;s <a href="http://pycurl.sourceforge.net/">PycURL</a>, Ruby&rsquo;s <a href="https://github.com/typhoeus/typhoeus">Typhoeus</a>, and many others, most of which simply wrap cURL (but have added the logic needed for some of its limitations).

	</br>
</br>
	</div>
</div>


        </div>
    </div>

<script>
    document.getElementById('bloglink').style.color = "#000000";
    document.getElementById('bloglink').style.background = "#FFFFFF";
</script>
</body>
</html>
